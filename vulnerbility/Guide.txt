UNIX (LINUX 전용)

1. 계정 관리
    1.1 root 계정 원격 접속 제한
        - 대상 : LINUX
        - 판단 기준
            - 양호 : 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우
            - 취약 : 원격 터미널 서비스 사용 시 root 직접 접속을 허용한 경우
        LINUX
            - Telnet
                #cat /etc/pam.d/login -> PAM을 사용하여 로그인 시도를 처리하는데 관련된 설정
                auth required /lib/security/pam_securetty.so
                #cat /etc/securetty -> TTY의 목록을 저장하는 파일
                pts/0 ~ pts/x 관련 설정이 존재하지 않음
            - SSH
                #cat /etc/ssh/sshd_config
                PermitRootLogin no
                
    1.2 패스워드 복잡성 설정
        - 대상 : LINUX
        - 판단 기준
            - 양호 : 패스워드 최소길이 8자리 이상, 영문·숫자·특수문자 최소 입력 기능이 설정된 경우
            - 취약 : 패스워드 최소 길이 8자리 이상, 영문·숫자·특수문자 최소 입력 기능이 설정된 경우
        LINUX
            # icredit = -1 -> 소문자 최소 1자 이상 요구
            # ucredit = -1 -> 최소 대문자 1자 이상 요구
            # dcredit = -1 -> 최소 숫자 요구, 최소 숫자 1자 이상 요구
            # ocredit = -1 -> 최소 특수문자 요구, 최소 특수문자 1자 이상 요구
            # minlen = 8 -> 최소 패스워드 길이 설정, 최소 8자리 이상 설정
            # difok = N -> 기존 패스워드와 비교, 기본값 10(50%))

            - LINUX - RHEL5
                #/etc/pam.d/system-auth, /etc/login.defs
                #/etc/pam.d/system-auth
            - LINUX - RHEL7
                #/etc/security/pwquality.conf
                password requisite pam_cracklib.so try_first_pass retry=3 minlen=8 lcredit=-1 uncredit=-1 dcredit=-1 ocredit=-1

    1.3 계정 잠금 임계값 설정
        - 대상 : LINUX
        - 판단 기준
            - 양호 : 계정 잠금 임계값이 10회 이하의 값으로 설정되어 있는 경우
            - 취약 : 계정 잠금 임계값이 설정되어 있지 않거나, 10회 이하의 값으로 설정되지 않은 경우

LINUX
    # no_magic_root -> root에게는 패스워드 잠금 설정을 적용하지 않음
    # deny=5 -> 5회 입력 실패 시 패스워드 잠금
    # unlock_time -> 계정 잠김 후 마지막 계정 실패 시간부터 설정된 시간이 지나면 자동 계정 잠김 해제 (단위 : 초)
    # reset -> 접속 시도 성공 시 실패한 횟수 초기화

    #cat /etc/pam.d/system-auth
    auth required /lib/security/pam_tally.so deny=5
    unlock_time=120 no_magic_root
    account required /lib/security/pam_tally.so
    no_magic_root_reset

